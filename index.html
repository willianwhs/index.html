<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>AJUDAAI Plataforma Suprema</title>

<style>
body{font-family:Arial;margin:0;background:#f4f6f8}
header{background:#fff;padding:20px;text-align:center;border-bottom:4px solid #FFC107}
h1{margin:0;font-size:34px}
.filtros{display:flex;flex-wrap:wrap;gap:10px;justify-content:center;margin-top:10px}
input{padding:10px;border-radius:8px;border:1px solid #ccc}
.botao{padding:10px 14px;background:#FFC107;border:none;border-radius:8px;font-weight:bold;cursor:pointer;text-decoration:none;color:#000}
.cards{display:grid;grid-template-columns:repeat(auto-fill,minmax(260px,1fr));gap:20px;padding:20px}
.card{background:#fff;border-radius:12px;padding:20px;text-align:center;box-shadow:0 6px 18px rgba(0,0,0,0.08)}
.loading{text-align:center;padding:40px;font-size:18px}
.vazio{text-align:center;padding:40px;font-size:18px}
.selo{background:#4CAF50;color:#fff;padding:4px 8px;border-radius:6px;font-size:12px;margin-bottom:6px}
.top{background:#ff5722;color:#fff;padding:4px 8px;border-radius:6px;font-size:12px;margin-bottom:6px}
.acoes{display:flex;gap:10px;justify-content:center;margin-top:15px;flex-wrap:wrap}
</style>
</head>

<body>

<header>
<h1>AJUDAAI SUPREMO</h1>
<p>Profissionais perto de você — rápido, seguro e inteligente</p>

<div class="filtros">
<input type="text" id="busca" placeholder="Buscar serviço ou cidade">
<button class="botao" onclick="filtrar()">Buscar</button>
<button class="botao" onclick="buscarProximos()">Perto de mim</button>
<button class="botao" onclick="somenteVerificados()">Verificados</button>
<button class="botao" onclick="ordenarRanking()">Melhores</button>
<button class="botao" onclick="render(prestadores)">Resetar</button>
</div>

<div class="filtros">
<a class="botao" href="SEU_FORM_CADASTRO" target="_blank">Cadastrar Prestador</a>
<a class="botao" href="SEU_FORM_ORCAMENTO" target="_blank">Pedir Orçamento</a>
<a class="botao" href="SEU_FORM_VERIFICADO" target="_blank">Quero Selo Verificado</a>
</div>

</header>

<div id="listaPrestadores" class="cards">
<div class="loading">Carregando plataforma AJUDAAI...</div>
</div>

<script>

let prestadores=[];
const FORM_AVALIACAO="SEU_FORM_AVALIACAO";

async function carregar(){
const res=await fetch("https://raw.githubusercontent.com/willianwhs/ajudaai/main/prestadores.json");
prestadores=await res.json();
ranking();
render(prestadores);
}

function ranking(){
prestadores.sort((a,b)=>(b.media||0)-(a.media||0));
if(prestadores[0])prestadores[0].top=true;
}

function render(lista){
const container=document.getElementById("listaPrestadores");
container.innerHTML="";

if(lista.length===0){
container.innerHTML="<div class='vazio'>Nenhum profissional encontrado</div>";
return;
}

lista.forEach(p=>{

const estrelas=p.media?"⭐".repeat(Math.round(p.media)):"Sem avaliações";
const selo=p.verificado?"<div class='selo'>VERIFICADO</div>":"";
const top=p.top?"<div class='top'>TOP AJUDAAI</div>":"";

container.innerHTML+=`
<div class="card">
${top}
${selo}
<h3>${p.nome}</h3>
<div>${p.servico}</div>
<div>${p.cidade}</div>
<div>${estrelas}</div>

<div class="acoes">
<a class="botao" href="https://wa.me/55${p.whatsapp}" target="_blank">Contratar</a>
<a class="botao" style="background:#1E3A8A;color:#fff" href="${FORM_AVALIACAO}?nome=${encodeURIComponent(p.nome)}" target="_blank">Avaliar</a>
</div>

</div>
`;
});
}

function filtrar(){
const termo=document.getElementById("busca").value.toLowerCase();
render(prestadores.filter(p=>
p.servico.toLowerCase().includes(termo)||
p.cidade.toLowerCase().includes(termo)
));
}

function somenteVerificados(){
render(prestadores.filter(p=>p.verificado));
}

function ordenarRanking(){
render([...prestadores].sort((a,b)=>(b.media||0)-(a.media||0)));
}

function distancia(lat1,lon1,lat2,lon2){
const R=6371;
const dLat=(lat2-lat1)*Math.PI/180;
const dLon=(lon2-lon1)*Math.PI/180;
const a=Math.sin(dLat/2)**2+
Math.cos(lat1*Math.PI/180)*Math.cos(lat2*Math.PI/180)*
Math.sin(dLon/2)**2;
return R*(2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a)));
}

function buscarProximos(){
navigator.geolocation.getCurrentPosition(pos=>{
const lat=pos.coords.latitude;
const lng=pos.coords.longitude;

const proximos=prestadores
.map(p=>{
if(!p.lat||!p.lng)return null;
return {...p,dist:distancia(lat,lng,p.lat,p.lng)};
})
.filter(p=>p&&p.dist<=20)
.sort((a,b)=>a.dist-b.dist);

render(proximos);
});
}

carregar();

</script>

</body>
</html>
