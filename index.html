<!DOCTYPE html><html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>AJUDA AI</title>  <!-- Leaflet (mapa gratuito) -->  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>  <style>
    :root{
      --azul:#0B5CFF;
      --amarelo:#FFD500;
      --bg:#F7F9FC;
      --texto:#1A1A1A;
      --card:#FFFFFF;
    }

    body{
      margin:0;
      font-family:Inter,Arial,Helvetica,sans-serif;
      background:var(--bg);
      color:var(--texto);
    }

    header{
      background:white;
      box-shadow:0 2px 8px rgba(0,0,0,0.06);
      padding:12px 20px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      position:sticky;
      top:0;
      z-index:10;
    }

    .logo{
      display:flex;
      align-items:center;
      gap:8px;
      font-weight:700;
      font-size:20px;
      color:var(--azul);
    }

    .logo img{height:28px}

    .btn{
      background:var(--amarelo);
      border:none;
      padding:10px 16px;
      border-radius:10px;
      font-weight:600;
      cursor:pointer;
    }

    .hero{
      padding:40px 20px;
      text-align:center;
    }

    .search{
      max-width:520px;
      margin:20px auto;
      display:flex;
      background:white;
      border-radius:14px;
      box-shadow:0 4px 16px rgba(0,0,0,0.08);
      overflow:hidden;
    }

    .search input{
      flex:1;
      border:none;
      padding:14px;
      font-size:16px;
      outline:none;
    }

    .search button{
      background:var(--azul);
      color:white;
      border:none;
      padding:0 18px;
      cursor:pointer;
    }

    .section{
      padding:30px 20px;
      max-width:1100px;
      margin:auto;
    }

    .grid{
      display:grid;
      grid-template-columns:repeat(auto-fit,minmax(240px,1fr));
      gap:16px;
    }

    .card{
      background:var(--card);
      border-radius:16px;
      padding:16px;
      box-shadow:0 6px 18px rgba(0,0,0,0.06);
    }

    #map{
      width:100%;
      height:380px;
      border-radius:16px;
    }

    /* MODAL */
    .modal{
      position:fixed;
      inset:0;
      background:rgba(0,0,0,0.4);
      display:none;
      align-items:center;
      justify-content:center;
      z-index:20;
    }

    .modal-content{
      background:white;
      border-radius:16px;
      padding:24px;
      width:95%;
      max-width:420px;
    }

    .modal-content h3{margin-top:0}

    .modal-content input{
      width:100%;
      padding:10px;
      margin:6px 0 12px;
      border-radius:8px;
      border:1px solid #ddd;
    }

    .stars span{
      font-size:22px;
      cursor:pointer;
      color:#ccc;
    }

    .stars span.active{color:#FFD500}

    @media(max-width:700px){
      .hero{padding:30px 16px}
      header{padding:10px 14px}
    }
  </style></head>
<body><header>
  <div class="logo">
    <img src="logo.png" alt="AJUDA AI">
    AJUDA AI
  </div>
  <button class="btn" onclick="abrirCadastro()">Cadastrar prestador</button>
</header><section class="hero">
  <h1>Encontre profissionais confi√°veis perto de voc√™</h1>
  <div class="search">
    <input placeholder="Qual servi√ßo voc√™ precisa?" />
    <button>Buscar</button>
  </div>
  <button class="btn" onclick="pertoDeMim()">üìç Perto de mim</button>
</section><section class="section">
  <h2>Profissionais pr√≥ximos</h2>
  <div id="map"></div>
</section><section class="section">
  <h2>Prestadores</h2>
  <div id="lista" class="grid"></div>
</section><!-- MODAL CADASTRO --><div id="modalCadastro" class="modal">
  <div class="modal-content">
    <h3>Cadastrar prestador</h3>
    <input id="nome" placeholder="Nome" />
    <input id="servico" placeholder="Servi√ßo" />
    <input id="cidade" placeholder="Cidade" />
    <input id="whatsapp" placeholder="WhatsApp" />
    <button class="btn" onclick="enviarCadastro()">Enviar</button>
  </div>
</div><!-- MODAL AVALIA√á√ÉO --><div id="modalAvaliacao" class="modal">
  <div class="modal-content">
    <h3>Avalie o prestador</h3>
    <div id="nomePrestador"></div>
    <div class="stars" id="stars"></div>
    <button class="btn" onclick="enviarAvaliacao()">Enviar avalia√ß√£o</button>
  </div>
</div><script>
const SHEET_JSON = "https://opensheet.elk.sh/1ImYSb5Cih3eGu7jqU3zjLTbvNvGTuhGjeTKSTo5_j7M/P√°gina1";

let map = L.map('map').setView([-22.73,-47.65],11);
L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',{attribution:'¬© OpenStreetMap'}).addTo(map);

async function carregarPrestadores(){
  const res = await fetch(SHEET_JSON);
  const data = await res.json();

  const lista = document.getElementById('lista');
  lista.innerHTML='';

  data.forEach(p=>{
    if(p.lat && p.lng){
      L.marker([p.lat,p.lng]).addTo(map)
        .bindPopup(`<b>${p.nome}</b><br>${p.servico}`);
    }

    lista.innerHTML += `
      <div class="card">
        <b>${p.nome}</b><br>
        ${p.servico}<br>
        ‚≠ê ${p.media || 0}
      </div>`;
  });
}

carregarPrestadores();

function abrirCadastro(){
  document.getElementById('modalCadastro').style.display='flex';
}

async function enviarCadastro(){
  const nome=document.getElementById('nome').value;
  const servico=document.getElementById('servico').value;
  const cidade=document.getElementById('cidade').value;
  const whatsapp=document.getElementById('whatsapp').value;

  navigator.geolocation.getCurrentPosition(async pos=>{
    const lat=pos.coords.latitude;
    const lng=pos.coords.longitude;

    await fetch("https://hook.us2.make.com/1851637",{
      method:"POST",
      headers:{"Content-Type":"application/json"},
      body:JSON.stringify({nome,servico,cidade,whatsapp,lat,lng})
    });

    alert("Cadastro enviado!");
    location.reload();
  });
}

function pertoDeMim(){
  navigator.geolocation.getCurrentPosition(pos=>{
    map.setView([pos.coords.latitude,pos.coords.longitude],13);
  });
}

// Avalia√ß√£o p√≥s-servi√ßo via link ?avaliar=Nome
const urlParams=new URLSearchParams(location.search);
const avaliar=urlParams.get('avaliar');

if(avaliar){
  document.getElementById('modalAvaliacao').style.display='flex';
  document.getElementById('nomePrestador').innerText=avaliar;
}

let nota=0;
const starsDiv=document.getElementById('stars');
for(let i=1;i<=5;i++){
  const s=document.createElement('span');
  s.innerText='‚òÖ';
  s.onclick=()=>{nota=i;renderStars()};
  starsDiv.appendChild(s);
}

function renderStars(){
  [...starsDiv.children].forEach((s,i)=>{
    s.classList.toggle('active',i<nota);
  });
}

async function enviarAvaliacao(){
  const prestador=avaliar;
  await fetch("https://hook.us2.make.com/avaliacao",{
    method:"POST",
    headers:{"Content-Type":"application/json"},
    body:JSON.stringify({prestador,nota})
  });
  alert("Avalia√ß√£o enviada");
}
</script></body>
</html>
