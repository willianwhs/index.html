<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>AJUDA AI | Intelig√™ncia em Servi√ßos</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    
    <style>
        :root {
            --brand-yellow: #FFB400; 
            --brand-yellow-hover: #E6A200;
            --brand-dark: #0F1115; 
            --card-bg: #181A20;
            --text-main: #FFFFFF;
            --text-muted: #94A3B8;
            --border: rgba(255, 255, 255, 0.08);
        }

        * { box-sizing: border-box; transition: all 0.2s ease; scroll-behavior: smooth; -webkit-tap-highlight-color: transparent; }
        body { margin: 0; font-family: 'Plus Jakarta Sans', sans-serif; background: var(--brand-dark); color: var(--text-main); overflow-x: hidden; width: 100%; }
        .container { max-width: 1200px; margin: auto; padding: 0 20px; width: 100%; }

        /* HEADER RESPONSIVO */
        header { 
            background: rgba(15, 17, 21, 0.95); 
            backdrop-filter: blur(12px);
            border-bottom: 1px solid var(--border);
            position: sticky; top: 0; z-index: 1000; padding: 12px 0;
        }
        .nav { display: flex; align-items: center; justify-content: space-between; }
        .logo { font-size: 22px; font-weight: 800; color: var(--brand-yellow); text-decoration: none; letter-spacing: -1px; }
        
        /* HERO ADAPT√ÅVEL */
        .hero { padding: 60px 0 30px; text-align: center; }
        .hero h1 { font-size: clamp(32px, 8vw, 58px); font-weight: 800; line-height: 1.1; margin: 0 0 15px; letter-spacing: -1.5px; }
        .hero h1 mark { background: none; color: var(--brand-yellow); }
        .hero p { font-size: clamp(16px, 4vw, 20px); color: var(--text-muted); max-width: 650px; margin: 0 auto 30px; padding: 0 10px; }

        /* BUSCA RESPONSIVA */
        .search-area {
            background: var(--card-bg); border: 1px solid var(--border);
            padding: 8px; border-radius: 20px; max-width: 700px; margin: auto;
            display: flex; flex-direction: row; gap: 8px; box-shadow: 0 20px 40px rgba(0,0,0,0.4);
        }
        .search-area input { flex: 1; background: transparent; border: none; padding: 14px 18px; color: white; font-size: 16px; outline: none; width: 100%; }
        
        .btn-main {
            background: var(--brand-yellow); color: #000; border: none;
            padding: 14px 25px; border-radius: 15px; font-weight: 800; cursor: pointer;
            font-size: 14px; white-space: nowrap;
        }

        /* CATEGORIAS COM SCROLL LATERAL NO MOBILE */
        .cat-section { padding: 20px 0; overflow-x: auto; -webkit-overflow-scrolling: touch; }
        .cat-container { display: flex; gap: 10px; justify-content: flex-start; min-width: max-content; padding-bottom: 10px; }
        @media (min-width: 768px) { .cat-container { justify-content: center; } }
        
        .cat-chip {
            padding: 10px 20px; border-radius: 100px; border: 1px solid var(--border);
            background: var(--card-bg); cursor: pointer; font-size: 13px; font-weight: 700; color: var(--text-muted);
        }
        .cat-chip.active { background: var(--brand-yellow); color: #000; border-color: var(--brand-yellow); }

        /* CONTE√öDO PRINCIPAL */
        #map { height: 300px; border-radius: 24px; border: 1px solid var(--border); margin: 20px 0; z-index: 10; width: 100%; }
        @media (min-width: 768px) { #map { height: 450px; } }

        .results-grid { display: grid; grid-template-columns: 1fr; gap: 20px; }
        @media (min-width: 640px) { .results-grid { grid-template-columns: repeat(2, 1fr); } }
        @media (min-width: 1024px) { .results-grid { grid-template-columns: repeat(3, 1fr); } }

        .card-provider { background: var(--card-bg); border: 1px solid var(--border); padding: 25px; border-radius: 24px; }
        .btn-connect {
            display: block; text-align: center; border: 1px solid var(--brand-yellow);
            padding: 12px; border-radius: 12px; text-decoration: none; color: var(--brand-yellow);
            font-weight: 800; font-size: 14px; margin-top: 15px;
        }

        /* QUEM SOMOS RESPONSIVO */
        .about-section { padding: 60px 0; background: rgba(255,255,255,0.02); margin-top: 40px; border-radius: 40px 40px 0 0; }
        .about-grid { display: grid; grid-template-columns: 1fr; gap: 40px; align-items: center; }
        @media (min-width: 900px) { .about-grid { grid-template-columns: 1.2fr 0.8fr; } }
        
        .about-content h2 { font-size: clamp(28px, 6vw, 42px); line-height: 1.1; margin: 15px 0; }
        .about-card-decorative {
            background: linear-gradient(135deg, var(--brand-yellow), #FF8C00);
            padding: 30px; border-radius: 25px; color: #000;
        }

        /* MODAL ADAPTADO PARA MOBILE */
        .modal-overlay {
            position: fixed; inset: 0; background: rgba(0,0,0,0.95); backdrop-filter: blur(10px);
            display: none; align-items: flex-start; justify-content: center; z-index: 2000; overflow-y: auto; padding: 20px 0;
        }
        .modal-body { 
            background: var(--card-bg); padding: 30px; border-radius: 24px; width: 90%; 
            max-width: 450px; border: 1px solid var(--border); margin: auto;
        }
        .modal-body input {
            width: 100%; padding: 15px; margin-bottom: 12px; background: rgba(255,255,255,0.05);
            border: 1px solid var(--border); border-radius: 12px; color: white; font-size: 16px;
        }

        /* AJUSTES MOBILE ESPEC√çFICOS */
        @media (max-width: 600px) {
            .search-area { flex-direction: column; border-radius: 15px; padding: 10px; }
            .btn-main { width: 100%; padding: 16px; }
            .nav a:nth-child(2) { display: none; } /* Esconde texto 'Quem Somos' no mobile para caber logo e bot√£o */
        }
    </style>
</head>
<body>

<header>
    <div class="container nav">
        <a href="#" class="logo">AJUDA<span>AI</span></a>
        <div style="display:flex; gap:15px; align-items:center;">
            <a href="#quem-somos" style="color:white; text-decoration:none; font-size:13px; font-weight:600;">Sobre</a>
            <button onclick="openModal()" class="btn-main" style="padding: 10px 15px; font-size: 11px;">SOU PRESTADOR</button>
        </div>
    </div>
</header>

<section class="hero">
    <div class="container">
        <h1>Sua busca<br>encontra a <mark>solu√ß√£o</mark>.</h1>
        <p>Conectamos voc√™ aos melhores profissionais locais com a seguran√ßa de uma fintech.</p>
        <div class="search-area">
            <input type="text" id="searchInput" placeholder="O que voc√™ precisa?" onkeyup="runFilters()">
            <button class="btn-main" onclick="runFilters()">BUSCAR</button>
        </div>
    </div>
</section>

<div class="cat-section">
    <div class="container cat-container">
        <div class="cat-chip active" onclick="setCategory('Tudo', this)">Tudo</div>
        <div class="cat-chip" onclick="setCategory('Reformas', this)">Reformas</div>
        <div class="cat-chip" onclick="setCategory('El√©trica', this)">El√©trica</div>
        <div class="cat-chip" onclick="setCategory('Limpeza', this)">Limpeza</div>
        <div class="cat-chip" onclick="setCategory('Manuten√ß√£o', this)">Reparos</div>
    </div>
</div>

<div class="container">
    <div id="map"></div>
    <div class="results-grid" id="providersList"></div>
</div>

<section id="quem-somos" class="about-section">
    <div class="container">
        <div class="about-grid">
            <div class="about-content">
                <span style="color:var(--brand-yellow); font-weight:800; font-size:12px; letter-spacing:1px;">QUEM SOMOS</span>
                <h2>Conectando talentos,<br>facilitando <mark>vidas</mark>.</h2>
                <p>
                    O <strong>AJUDA AI</strong> √© a ponte tecnol√≥gica entre a sua necessidade e o talento local. 
                    Unimos geolocaliza√ß√£o e seguran√ßa para garantir que o profissional ideal esteja a poucos cliques de dist√¢ncia.
                </p>
                <div style="display:grid; grid-template-columns: repeat(2, 1fr); gap:15px; margin-top:20px;">
                    <div><b style="color:var(--brand-yellow); font-size:18px;">Local</b><br><small>Foco na sua regi√£o</small></div>
                    <div><b style="color:var(--brand-yellow); font-size:18px;">Direto</b><br><small>Via WhatsApp</small></div>
                </div>
            </div>
            <div class="about-image">
                <div class="about-card-decorative">
                    <h3>Miss√£o</h3>
                    <p style="font-weight:600; line-height:1.4; margin:0;">Impulsionar a economia local atrav√©s de conex√µes inteligentes e seguras.</p>
                </div>
            </div>
        </div>
    </div>
</section>

<div class="modal-overlay" id="modalOverlay">
    <div class="modal-body">
        <h2 style="margin-top:0; font-size: 24px;">Seja um Parceiro</h2>
        <form id="mainForm">
            <input name="nome" placeholder="Nome ou Empresa" required>
            <input name="servico" placeholder="Especialidade (ex: Pintor)" required>
            <input name="cidade" placeholder="Sua Cidade" required>
            <input name="whatsapp" type="tel" placeholder="WhatsApp (DDD + N√∫mero)" required>
            <input type="hidden" name="lat" id="lat" value="0">
            <input type="hidden" name="lng" id="lng" value="0">
            <button type="submit" class="btn-main" id="submitBtn" style="width:100%; margin-top:10px; padding: 18px;">CADASTRAR PERFIL</button>
            <button type="button" onclick="closeModal()" style="width:100%; background:none; border:none; color:white; margin-top:15px; cursor:pointer; opacity:0.5; font-size: 14px;">Voltar</button>
        </form>
    </div>
</div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script>
    let providers = [];
    let activeCat = 'Tudo';
    const map = L.map('map', { zoomControl: false, scrollWheelZoom: false }).setView([-22.75, -47.33], 12);
    
    L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png').addTo(map);

    function openModal() { 
        document.getElementById('modalOverlay').style.display='flex'; 
        if(navigator.geolocation) navigator.geolocation.getCurrentPosition(p=>{
            document.getElementById('lat').value=p.coords.latitude;
            document.getElementById('lng').value=p.coords.longitude;
        }, () => console.log("GPS negado"), {timeout: 5000});
    }
    
    function closeModal() { document.getElementById('modalOverlay').style.display='none'; }

    async function fetchData() {
        try {
            const res = await fetch("https://opensheet.elk.sh/1ImYSb5Cih3eGu7jqU3zjLTbvNvGTuhGjeTKSTo5_j7M/P√°gina1");
            providers = await res.json();
            runFilters();
        } catch(e) { console.error("Erro ao carregar"); }
    }

    function setCategory(cat, el) {
        document.querySelectorAll('.cat-chip').forEach(c => c.classList.remove('active'));
        el.classList.add('active');
        activeCat = cat;
        runFilters();
    }

    function runFilters() {
        const query = document.getElementById('searchInput').value.toLowerCase();
        const filtered = providers.filter(p => {
            const mCat = activeCat === 'Tudo' || p.servico.toLowerCase().includes(activeCat.toLowerCase());
            const mText = p.nome.toLowerCase().includes(query) || p.servico.toLowerCase().includes(query) || p.cidade.toLowerCase().includes(query);
            return mCat && mText;
        });
        render(filtered);
    }

    function render(data) {
        const box = document.getElementById('providersList');
        box.innerHTML = "";
        map.eachLayer(l => { if(l instanceof L.Marker) map.removeLayer(l); });

        data.forEach(p => {
            const card = document.createElement('div');
            card.className = 'card-provider';
            card.innerHTML = `
                <div style="color:var(--brand-yellow); font-size:11px; font-weight:800; text-transform:uppercase;">${p.servico}</div>
                <h3 style="margin:8px 0 4px; font-size:20px;">${p.nome}</h3>
                <p style="color:var(--text-muted); font-size:14px; margin:0;">üìç ${p.cidade}</p>
                <a href="https://wa.me/55${p.whatsapp.replace(/\D/g,'')}" target="_blank" class="btn-connect">WHATSAPP</a>
            `;
            box.appendChild(card);
            
            if(p.lat && p.lng && p.lat != 0) {
                const markerIcon = L.divIcon({
                    className: 'marker',
                    html: `<div style='background-color:var(--brand-yellow); width:12px; height:12px; border-radius:50%; border:2px solid white; box-shadow:0 0 8px var(--brand-yellow);'></div>`,
                    iconSize: [12, 12]
                });
                L.marker([p.lat, p.lng], {icon: markerIcon}).addTo(map);
            }
        });
    }

    mainForm.onsubmit = async (e) => {
        e.preventDefault();
        const btn = document.getElementById('submitBtn');
        btn.innerText = "ENVIANDO...";
        btn.disabled = true;

        const fd = new FormData(mainForm);
        const payload = Object.fromEntries(fd);

        if(payload.lat == "0") {
            try {
                const geo = await fetch(`https://nominatim.openstreetmap.org/search?q=${encodeURIComponent(payload.cidade)}&format=json&limit=1`).then(r=>r.json());
                if(geo[0]) { payload.lat = geo[0].lat; payload.lng = geo[0].lon; }
            } catch(e) {}
        }

        try {
            await fetch("https://hook.us2.make.com/rmdusinc4e6pg1akovep4zrd6rw1fpyw", {
                method: 'POST', 
                headers: {'Content-Type':'application/json'},
                body: JSON.stringify(payload)
            });
            alert("Cadastro realizado!");
            closeModal();
            fetchData();
        } catch(e) { alert("Erro ao cadastrar."); }
        
        btn.innerText = "CADASTRAR PERFIL";
        btn.disabled = false;
    }

    fetchData();
</script>
</body>
</html>
